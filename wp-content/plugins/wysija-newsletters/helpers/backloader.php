<?php
defined('WYSIJA') or die('Restricted access'); class WYSIJA_help_backloader extends WYSIJA_help{ function WYSIJA_help_backloader(){ parent::WYSIJA_help(); } function initLoad(&$controller){ wp_enqueue_style('wysija-admin-css', WYSIJA_URL."css/admin.css"); wp_enqueue_script('wysija-admin-if', WYSIJA_URL."js/admin-wysija.js", array( 'jquery' ), true); if(!$controller->jsTrans){ $controller->jsTrans["selecmiss"]=__('Please make a selection first!',WYSIJA); $controller->jsTrans["suredelete"]=__('Deleting a list will not delete any subscribers.',WYSIJA); } $controller->js[]='wysija-admin-ajax'; $controller->js[]='thickbox'; wp_enqueue_style( 'thickbox' ); } function loadScriptsStyles($pagename,$dirname,$urlname,&$controller,$extension="newsletter") { if(file_exists($dirname."js".DS."admin-".$pagename.".js")) wp_enqueue_script('wysija-'.$extension.'-admin-'.$pagename, $urlname."js/admin-".$pagename.".js"); if(file_exists($dirname."js".DS."admin-".$pagename.".php")) wp_enqueue_script('wysija-'.$extension.'-admin-'.$pagename, $urlname."js/admin-".$pagename.".php"); if(file_exists($dirname."css".DS."admin-".$pagename.".css")) wp_enqueue_style('wysija-'.$extension.'-admin-'.$pagename."css", $urlname."css/admin-".$pagename.".css"); if(isset($_GET['action'])){ if(file_exists($dirname."js".DS."admin-".$pagename."-".$_REQUEST['action'].".js")) wp_enqueue_script('wysija-'.$extension.'-admin-'.$pagename."-".$_REQUEST['action'], $urlname."js/admin-".$pagename."-".$_REQUEST['action'].".js"); if(file_exists($dirname."js".DS."admin-".$pagename."-".$_REQUEST['action'].".php")) wp_enqueue_script('wysija-'.$extension.'-admin-'.$pagename."-".$_REQUEST['action'], $urlname."js/admin-".$pagename."-".$_REQUEST['action'].".php"); if(file_exists($dirname."css".DS."admin-".$pagename."-".$_REQUEST['action'].".css")) wp_enqueue_style('wysija-'.$extension.'-admin-'.$pagename."-".$_REQUEST['action'], $urlname."css/admin-".$pagename."-".$_REQUEST['action'].".css"); if($_GET['action']=="edit" || $_GET['action']=="add") $controller->js[]="wysija-validator"; }else{ if(file_exists($dirname."js".DS."admin-".$pagename."-default".".js")) wp_enqueue_script('wysija-'.$extension.'-admin-'.$pagename."-default", $urlname."/js/admin-".$pagename."-default.js"); if($pagename!="config") wp_enqueue_script('wysija-admin-list'); } return true; } function jsParse(&$controller,$pagename,$urlbase=WYSIJA_URL){ if($controller->js){ foreach($controller->js as $kjs=> $js){ switch($js){ case "jquery-ui-tabs": wp_enqueue_script($js); wp_enqueue_style('wysija-tabs-css', WYSIJA_URL."css/smoothness/jquery-ui-1.8.15.custom.css"); break; case "wysija-validator": wp_enqueue_script('wysija-validator-lang'); wp_enqueue_script($js); wp_enqueue_script('wysija-form'); wp_enqueue_style('validate-engine-css'); break; case "wysija-admin-ajax": wp_localize_script( 'wysija-admin-ajax', 'wysijaAJAX', array( 'action' => 'wysija_ajax', 'controller' => $pagename, 'dataType'=>"json", 'ajaxurl'=>admin_url( 'admin-ajax.php' ), 'adminurl'=>admin_url( 'admin.php' ), 'loadingTrans' =>__('Loading...',WYSIJA) )); wp_enqueue_script("jquery-ui-dialog"); wp_enqueue_script($js); wp_enqueue_style('wysija-tabs-css', WYSIJA_URL."css/smoothness/jquery-ui-1.8.15.custom.css"); break; case "wysija-admin-ajax-proto": wp_enqueue_script($js); break; case "wysija-editor": wp_enqueue_script("wysija-prototype", WYSIJA_URL."js/prototype/prototype.js"); wp_deregister_script('thickbox'); wp_register_script('thickbox',WYSIJA_URL."js/thickbox/thickbox.js"); wp_localize_script('thickbox', 'thickboxL10n', array( 'next' => __('Next &gt;'), 'prev' => __('&lt; Prev'), 'image' => __('Image'), 'of' => __('of'), 'close' => __('Close'), 'noiframes' => __('This feature requires inline frames. You have iframes disabled or your browser does not support them.'), 'l10n_print_after' => 'try{convertEntities(thickboxL10n);}catch(e){};' )); wp_enqueue_script("wysija-proto-scriptaculous", WYSIJA_URL."js/prototype/scriptaculous.js?load=effects",array("wysija-prototype")); wp_enqueue_script("wysija-proto-dragdrop", WYSIJA_URL."js/prototype/dragdrop.js",array("wysija-proto-scriptaculous")); wp_enqueue_script("wysija-proto-controls", WYSIJA_URL."js/prototype/controls.js",array("wysija-proto-scriptaculous")); wp_enqueue_script("wysija-timer", WYSIJA_URL."js/timer.js"); wp_enqueue_script($js, WYSIJA_URL."js/".$js.".js"); wp_enqueue_script('wysija-tinymce', WYSIJA_URL."js/tinymce/tiny_mce.js"); wp_enqueue_script('wysija-tinymce-init', WYSIJA_URL."js/tinymce_init.js"); wp_enqueue_style('wysija-editor-css', WYSIJA_URL."css/wysija-editor.css"); wp_enqueue_script('wysija-colorpicker', WYSIJA_URL."js/jscolor/jscolor.js"); wp_localize_script('wysija-editor', 'Wysija_i18n', $controller->jsTrans); break; default: if(is_string($kjs)) wp_enqueue_script($js,$urlbase."/js/".$js.".js"); else wp_enqueue_script($js); } } } } } 